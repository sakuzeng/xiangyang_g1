# Torso坐标系原点 (相对Pelvis)
```
torso_origin = [
    0.0,      # X: 与pelvis同一前后位置
    0.0,      # Y: 与pelvis同一左右位置
    0.044     # Z: 骨盆上方4.4cm (腰部)
]
```
# Torso坐标轴方向 (右手坐标系)
```
        Z (向上)
        ↑
        |
        |____→ X (向前)
       /
      /
     ↙ Y (向左)
     
物理含义:
- X轴正方向: 机器人胸部朝向,前进方向
- Y轴正方向: 从右肩指向左肩
- Z轴正方向: 从腰部指向头顶
```




# 光学坐标系 → 机械坐标系
RealSense 使用光学坐标系（Z前，X右，Y下），而 URDF 标准使用机械坐标系（X前，Y左，Z上）
- 相机光轴方向（Z轴）对应 机械系的前方（X轴）
- 光学系的右侧（+X）对应 机械系的右侧（-Y）
- 光学系的下方（+Y）对应 机械系的下方（-Z）
如果是水平安装的话比较好理解，斜向下安装的或需要后序进行变换（此时x轴是斜向下的，需要进行旋转）

# 机械坐标系 → Torso坐标系
## urdf提供的参数
参数	值	单位	物理含义
xyz	[0.0576235, 0.01753, 0.42987]	米	相机在 Torso 坐标系中的位置
- X	0.0576235	米	前方 5.76cm（胸部前方）
- Y	0.01753	米	左侧 1.75cm（略微偏左）
- Z	0.42987	米	上方 43cm（胸部高度）
rpy	[0, 0.8308, 0]	弧度	相机旋转姿态
- Roll	0	弧度	无侧倾
- Pitch	0.8308	弧度	向下倾斜 47.6°
- Yaw	0	弧度	无偏航

## 实际变换过程：
基础参数
```xml
<joint name="d435_joint" type="fixed">
    <origin xyz="0.0576235 0.01753 0.42987" 
            rpy="0 0.8307767239493009 0"/>
    <parent link="torso_link"/>
    <child link="d435_link"/>
</joint>
```
rpy:
Roll（横滚角）：绕 X 轴 的旋转角度（单位为弧度）  
Pitch（俯仰角）：绕 Y 轴 的旋转角度（单位为弧度）  
Yaw（偏航角）：绕 Z 轴 的旋转角度（单位为弧度）  
parent link绕Y轴顺时针旋转相应的弧度得到child link  
urdf_trans = np.array([0.0576235, 0.01753, 0.42987])(相机在 Torso 坐标系中的位置 (平移向量))  
base_pitch = 0.8307767239493009  # 约 47.6°(rpy: 相机相对 Torso 的姿态 (旋转欧拉角))
校准偏移  
pitch_offset = 0.23   
final_pitch = base_pitch + pitch_offset    
第一阶段依据rpy先进行旋转变换, 只有 pitch 非零,对link坐标系中的点进行变换  
第二阶段依据urdf_trans进行平移变换,最终映射到torso坐标系中  

# 转换过程中的问题
- 深度数据由于反射或别的原因接收不到
- 采用同心圆搜索    从中心向外扩散，半径1→20px ,取中值附近最优点
- 上面的悬挂东西挡住后会使深度值无效

---

